<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Rasberry Pie Deployer</title>

    <!-- CSS -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,100,300,500">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/form-elements.css">
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

    <!-- Favicon and touch icons -->
    <link rel="shortcut icon" href="assets/ico/favicon.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">

    <!-- Javascript -->
    <script src="assets/js/jquery-1.11.1.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.backstretch.min.js"></script>
    <script src="assets/js/scripts.js"></script>
</head>

<body onload="myFunction()">


    <!-- Top content -->
    <section id="form" class="top-content">
        <div class="inner-bg">
            <div class="container">
                <div class="row">
                    <div class="col-sm-8 col-sm-offset-2 text">
                        <h1><strong>Connect To Server</strong></h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6 col-sm-offset-3 form-box">
                        <div class="form-top">
                            <div class="form-top-left">
                                <h3>Deployer Details</h3>
                                <p>Enter details to connect and deploy:</p>
                            </div>
                            <div class="form-top-right">
                                <a href="https://github.com/login/oauth/authorize?client_id=9ef838536d7516d3ab56&amp;scope=write:repo_hook">
                                    <i class="fa fa-github-square" aria-hidden="true">
                                </i>
                                </a>
                            </div>
                        </div>
                        <div class="form-bottom">
                            <form role="form" action="" method="post" class="login-form" id="login-form">
                                <div class="form-group">
                                    <label class="sr-only" for="form-username">Username</label>
                                    <input list="ipList" type="text" name="form-username" placeholder="Enter Client Ip" class="form-username form-control" id="form-username">
                                    <datalist id="ipList"></datalist>
                                    <script type="text/javascript">
                                        var list = [];
                                        window.onload = function () {
                                            jQuery.ajax({
                                                type: "GET",
                                                url: "https://104.196.235.71/deployer/v1/list",
                                                dataType: "json",
                                                success: function (data, textStatus, jqXHR) {
                                                    data.forEach(function (element) {
                                                        list.push(element);
                                                    }, this);
                                                    console.log(data.length + textStatus);
                                                    addItems(list);
                                                }, //function(data, textStatus, jqXHR)
                                                error: function (jqXhr, textStatus, errorThrown) {
                                                    console.log(errorThrown); //function(jqXHR, textStatus, errorThrown)
                                                }
                                            });
                                        }

                                        function addItems(list) {
                                            console.log(list);
                                            var options = '';
                                            for (var i = 0; i < list.length; i++) {
                                                options += '<option value="' + list[i] + '" />';
                                                console.log(list[i]);
                                            }
                                            document.getElementById('ipList').innerHTML = options;
                                        }
                                    </script>
                                </div>
                                <div class="form-group">
                                    <label class="sr-only" for="form-password">Password</label>
                                    <input list="repo_list" type="text" name="form-password" placeholder="Enter Github Repo Url" class="form-password form-control"
                                        id="form-password">
                                    <datalist id="repo_list"></datalist>
                                    <a id="find" href="#" data-toggle="modal" data-target="#myModal">Find</a>
                                </div>
                                <button type="submit" class="btn" id="btn">Deploy!</button>
                                <p class="message">Already Deployed? <a href="#">Check Status</a></p>

                            </form>
                            <form role="form" action="" method="post" class="login-form" id="login-form1" style="display:none">
                                <div class="form-group">

                                    <input list="ipList" type="text" name="form-username" placeholder="Enter Client Ip" class="form-username form-control" id="form-username">
                                    <datalist id="ipList"></datalist>
                                    <script type="text/javascript">
                                        var list = [];
                                        window.onload = function () {
                                            jQuery.ajax({
                                                type: "GET",
                                                url: "https://104.196.235.71/deployer/v1/list",
                                                dataType: "json",
                                                success: function (data, textStatus, jqXHR) {
                                                    data.forEach(function (element) {
                                                        list.push(element);
                                                    }, this);
                                                    console.log(data.length + textStatus);
                                                    addItems(list);
                                                }, //function(data, textStatus, jqXHR)
                                                error: function (jqXhr, textStatus, errorThrown) {
                                                    console.log(errorThrown); //function(jqXHR, textStatus, errorThrown)
                                                }
                                            });
                                        }

                                        function addItems(list) {
                                            console.log(list);
                                            var options = '';
                                            for (var i = 0; i < list.length; i++) {
                                                options += '<option value="' + list[i] + '" />';
                                                console.log(list[i]);
                                            }
                                            document.getElementById('ipList').innerHTML = options;
                                        }
                                    </script>
                                </div>

                                <button type="submit" class="btn" id="btn">Check Status!</button>
                                <p class="message">Need to Deploy? <a href="#">Deploy</a></p>
                            </form>
                            <div id="output" style="margin-top:20px; display:none;">
                                <h3 id="status" style="color:white;"> Status: </h3>
                                <p id="result" style="color:white"> </p>
                                <center><button class="btn" onclick="myFunction1()">Refresh</button></center>

                                <script>
                                    function myFunction1() {
                                        var ip = document.getElementById("login-form")[0].value;
                                        jQuery.ajax({
                                            type: "GET",
                                            url: "https://104.196.235.71/deployer/v1/" + ip + "/status",
                                            dataType: "json",
                                            success: function (data, textStatus, jqXHR) {
                                                console.log(data + textStatus);
                                                $('#output').show();
                                                list = data.packages;
                                                var message = "";
                                                list.forEach(function (element) {
                                                    message += "<b>Repo Url</b> :" + element.url +
                                                        "--> <b>Status</b> : " + element.status +
                                                        "<br>";
                                                }, this);
                                                document.getElementById("result").innerHTML = message;
                                                document.getElementById("status").innerHTML = "Status: " +
                                                    textStatus;
                                            }, //function(data, textStatus, jqXHR)
                                            error: function (jqXhr, textStatus, errorThrown) {

                                                console.log(errorThrown); //function(jqXHR, textStatus, errorThrown)
                                            }
                                        });
                                    }
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-body">
                    <input placeholder="Enter GitHub Username" type="text" class="form-control" id="git_user">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" onclick="findRepo()">Find Repositories</button>
                </div>
            </div>
        </div>
        <script>
            function findRepo() {
                var username = document.getElementById("git_user").value;
                jQuery.ajax({
                    type: "GET",
                    url: "https://api.github.com/users/" + username + "/repos",
                    dataType: "json",
                    success: function (data, textStatus, jqXHR) {
                        var list = [];
                        data.forEach(function (element) {
                            list.push(element.html_url);
                        }, this);
                        addRepos(list);
                    
                    }, //function(data, textStatus, jqXHR)
                    error: function (jqXhr, textStatus, errorThrown) {
                            $(document).ready(function () {
                                console.log("error");
                                jQuery('#error').html(
                                    '<div class="alert alert-danger show" id="alert"><a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a><strong>Info!</strong>' +
                                     "Invalid username"+ '</div>'
                                );
                            });

                            window.setTimeout(function () {
                                $("#alert").fadeTo(500, 0).slideUp(500, function () {
                                    $(this).remove();
                                });
                            }, 3000);
                        console.log(errorThrown); //function(jqXHR, textStatus, errorThrown)
                    }
                });
            }

            function addRepos(list) {
                var options = '';
                if (list.length > 0) {
                    document.getElementById('find').style.display = 'none';
                }
                for (var i = 0; i < list.length; i++) {
                    options += '<option value="' + list[i] + '" />';
                }
                document.getElementById('repo_list').innerHTML = options;
            }
        </script>
    </div>
    <div style="padding:5px;" id="message">
    </div>
    <div style="padding:5px;" id="error">
    </div>

    <!--[if lt IE 10]>
            <script src="assets/js/placeholder.js"></script>
        <![endif]-->



    <div class="backstretch" style="left: 0px; top: 0px; overflow: hidden; margin: 0px; padding: 0px; height: 522px; width: 1903px; z-index: -999999; position: fixed;"><img src="assets/img/backgrounds/1.jpg" style="position: absolute; margin: 0px; padding: 0px; border: none; width: 1903px; height: 1070.44px; max-height: none; max-width: none; z-index: -999999; left: 0px; top: -274.219px;"></div>


</body>

</html>